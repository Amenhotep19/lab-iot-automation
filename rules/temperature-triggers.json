{"_id":{"$oid":"5749ca4f54660b978dd22e71"},"id":"temperature_too_hot","name":"temperature_too_hot","sensor_id":"temperature","condition":"( \n  function(data) {\n\u0009var temp_high_threshold = 27;\n    return data.value \u003e temp_high_threshold\n\u0009  \u0009\u0026\u0026 this.stash[\"temperature_prev\"] \u003c= temp_high_threshold; \n  } \n)","triggerFunc":"( \n  function(data) { \n\u0009var alert = {\n      sensor_id: data.sensor_id,\n      value: data.value,\n      timestamp: data.timestamp,\n      alert: \"TOO_HOT\"\n    };\n\u0009\n\u0009this.mqttClient.publish('sensors/temperature/alerts', JSON.stringify(alert) );\n\n    var options = {\n        method: 'POST',\n        uri: 'http://192.168.1.118:3000/lcd/backlight?r=255\u0026g=0\u0026b=0'};\n\n    this.http(options)\n        .then(function (body) {\n         //   console.log(\"Set LCD Backlight to RED\");\n        })\n        .catch(function (err) {\n         //   console.log(err);\n        });\n\n\n    var options2 = {\n        method: 'POST',\n        uri: 'http://192.168.1.101:3000/relay/power'\n    };\n\n    this.http(options2)\n        .then(function (body) {\n         //   console.log(\"Mini-Fridge turned on\");\n        })\n        .catch(function (err) {\n           // console.log(err);\n        });\n\n    // Turn off heat lamp\n    var options3 = {\n        method: 'DELETE',\n        uri: 'http://192.168.1.113:3000/relay/power'\n    };\n\n    this.http(options3)\n        .then(function (body) {\n           // console.log(\"Heat Lamp Turned Off\");\n        })\n        .catch(function (err) {\n           // console.log(err);\n        });\n  }\n)","active":true,"__v":0}
{"_id":{"$oid":"5749cd2c54660b978dd22e72"},"id":"temperature_too_cold","name":"temperature_too_cold","sensor_id":"temperature","condition":"( \n  function(data) { \n\u0009var temp_low_threshold = 20;\n\u0009  return data.value \u003c temp_low_threshold\n      \u0009\u0026\u0026 this.stash[\"temperature_prev\"] \u003e= temp_low_threshold;\n  } \n)","triggerFunc":"( \n  function(data) { \n\u0009var alert = {\n      sensor_id: data.sensor_id,\n      value: data.value,\n      timestamp: data.timestamp,\n      alert: \"TOO_COLD\"\n    };\n\u0009\n\u0009this.mqttClient.publish('sensors/temperature/alerts', JSON.stringify(alert) );\n\n    var options = {\n        method: 'POST',\n        uri: 'http://192.168.1.118:3000/lcd/backlight?r=0\u0026g=0\u0026b=255'\n    };\n\n    this.http(options)\n        .then(function (body) {\n          //  console.log(\"Set LCD Backlight to Blue\");\n        })\n        .catch(function (err) {\n            //console.log(err);\n        });\n\n\n    // Turn on Heat Lamp\n    var options2 = {\n        method: 'POST',\n        uri: 'http://192.168.1.113:3000/relay/power'\n    };\n\n    this.http(options2)\n        .then(function (body) {\n            //console.log(\"Heat Lamp turned On\");\n        })\n        .catch(function (err) {\n            //console.log(err);\n        });\n\n    // Turn off mini-fridge\n    var options3 = {\n        method: 'DELETE',\n        uri: 'http://192.168.1.101:3000/relay/power'\n    };\n\n    this.http(options3)\n        .then(function (body) {\n           // console.log(\"Mini-Fridge Turned Off\");\n        })\n        .catch(function (err) {\n           // console.log(err);\n        });\n\n  }\n)","active":true,"__v":0}
{"_id":{"$oid":"5749d19154660b978dd22e73"},"id":"temperature_ok","name":"temperature_ok","sensor_id":"temperature","condition":"( \n  function(data) { \n\u0009var temp_low_threshold = 20;\n\u0009var temp_high_threshold = 27;\n    return data.value \u003e temp_low_threshold\n        \u0026\u0026 data.value \u003c= temp_high_threshold\n        \u0026\u0026 (this.stash[\"temperature_prev\"] \u003c= temp_low_threshold\n            || this.stash[\"temperature_prev\"] \u003e temp_high_threshold);\n  }\n)","triggerFunc":"( \n  function(data) {\n\u0009\n    var alert = {\n      sensor_id: data.sensor_id,\n      value: data.value,\n      timestamp: data.timestamp,\n      alert: \"OK\"\n    };\n\n    this.mqttClient.publish('sensors/temperature/alerts', JSON.stringify(alert) );\n\n    var options = {\n        method: 'POST',\n        uri: 'http://192.168.1.118:3000/lcd/backlight?r=255\u0026g=255\u0026b=255'};\n\n    this.http(options)\n        .then(function (body) {\n           // console.log(\"Post Success\");\n        })\n        .catch(function (err) {\n            //console.log(err);\n        });\n\n\n    // Turn off heat lamp\n    var options = {\n        method: 'DELETE',\n        uri: 'http://192.168.1.113:3000/relay/power'\n    };\n\n    this.http(options)\n        .then(function (body) {\n            //console.log(\"Post Success\");\n        })\n        .catch(function (err) {\n            //console.log(err);\n        });\n\n    // Turn off mini-fridge\n    var options2 = {\n        method: 'DELETE',\n        uri: 'http://192.168.1.101:3000/relay/power'\n    };\n\n    this.http(options2)\n        .then(function (body) {\n            //console.log(\"Post Success\");\n        })\n        .catch(function (err) {\n            //console.log(err);\n        });\n\n  }\n)","active":true,"__v":0}
{"_id":{"$oid":"5749d28f54660b978dd22e74"},"id":"temperature_changed","name":"temperature_changed","sensor_id":"temperature","condition":"( \n  function(data) { \n\u0009  return this.stash[\"temperature\"] != this.stash[\"temperature_prev\"];\n  } \n)","triggerFunc":"( \n  function(data) {\n\u0009var temp = parseInt(data.value).toPrecision(3);\n\n    var options = {\n        method: 'POST',\n        uri: 'http://192.168.1.118:3000/lcd/text?lcdtext=' + temp + \" Celsius\"};\n\n    this.http(options)\n        .then(function (body) {\n          //  console.log(\"Changed temperature on LCD\");\n        })\n        .catch(function (err) {\n          //  console.log(err);\n        });\n\n  }\n)","active":true,"__v":0}
